<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0070)https://www.fit.vutbr.cz/study/courses/IIS/private/projekt/doc.html.cs -->
<html class=" aaxfusc idc0_321" lang="cs"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
    
    <title>Projekt IIS</title>
    <style type="text/css">
    	table { border-collapse: collapse; }
    	td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
    	dt { font-weight: bold; margin-top: 0.5em; }
    </style>
</head>
<body>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu 
     podle pou¾itého editoru -->

<h1>2. Hotel: rezervace a správa ubytování</h1> <!-- Nahradte názvem svého zadání -->

<dl>
	<dt>Autoøi</dt>
	<dd>Martin Haderka <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
		<a href="mailto:xhader00@stud.fit.vutbr.cz">xhader00@stud.fit.vutbr.cz</a>
		<ul>
			<li>Zaji¹tìní hostingu a doménového jména.</li>
			<li>Návrh a testování UI.</li>
			<li>Spolupráce na Flask controlleru.</li>
			<li>Vytvoøení front-end èásti (ReactJS aplikace).</li>
			<li>Spolupráce na dokumentaci</li>
		</ul>
	</dd>
	<dd>Richard Klem <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
		<a href="mailto:xklemr00@stud.fit.vutbr.cz">xklemr00@stud.fit.vutbr.cz</a>
		<ul>
			<li>Vytvoøení MySQL databáze a testovacích dat</li>
			<li>Vytvoøení Flask controlleru</li>
			<li>Spolupráce na front-end èásti (ReactJS aplikace).</li>
			<li>Testování controlleru</li>
			<li>Testování front-end èásti</li>
			<li>Vytvoøení dokumentace</li>
		</ul>
	</dd>
	<dt>URL aplikace</dt>
	<dd><a href="http://iis-projekt.ddns.net/">http://iis-projekt.ddns.net/</a></dd>
	<dd><a href="http://93.153.43.141/">http://93.153.43.141/</a></dd>
</dl>
<br/>
<h2>U¾ivatelé systému pro testování</h2>
<table>
<tbody><tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
<tr><td>admin@iis-hotel.cz</td><td>1234</td><td>administrátor</td></tr>
<tr><td>vlastnik@iis-hotel.cz</td><td>1234</td><td>vlastník</td></tr>
<tr><td>recepcni@iis-hotel.cz</td><td>1234</td><td>recepèní</td></tr>
<tr><td>martin@email.cz</td><td>1234</td><td>zákazník</td></tr>
<tr><td>john.appleseed@apple.com</td><td>1234</td><td>zákazník</td></tr>
</tbody></table> 
<br/>
<br/>
<h2>Softwarové po¾adavky</h2>
<ul>
	<li>Python 3.7+</li>
	<li>Python modul pip</li>
	<li>node v14.13.x</li>
	<li>npm 6.14.x</li>
</ul>
<p>React aplikace byla testována na verzi node v14.13.1 a npm 6.14.8.<br/>
V pøípadì pou¾ití podobných verzí by funkcionalita nemìla být poru¹ena, ale nelze to zaruèit.
<br/>
<br/>
V cestì <code>PATH</code> musí být <code>$HOME/.local/bin</code>.
</p>

<h2>Postup inicializace databáze</h2>
Nutnou prerekvizitou je zprovoznìný lokální MySQL server.<br/>
K inicializaci databáze se vyu¾uje scriptu <b>mysql_iis.sql</b>, který je umístìn ve slo¾ce database.<br/>
Pøíkazem:<br/>
<ul>
	<li>
	<code>cat mysql_iis.sql | sudo mysql -u root</code>
</li>
</ul>
se inicilizuje databáze, vytvoøí se databázový u¾ivatel xklemr00 (který je potøeba pro správné fungování Flask serveru) a databáze se naplní ukázkovými daty.<br/>
<h2>Instalace a spu¹tìní</h2>
	<div>
		Otevøete si dva terminály. V prvním pobì¾í Flask server, v druhém React aplikace.
		Pøíkazy pro nastartování Flask serveru v prvním terminálu:
		<ul>
			<li><code>cd backend</code></li>
			<li><code>python3 -m pip install -r requirements.txt</code></li>
			<li><code>flask run</code></li>
		</ul>
		Pøíkazy pro nastartování React aplikace v druhém terminálu:
		<ul>
			<li><code>cd frontend</code></li>
			<li><code>npm i</code></li>
			<li><code>npm start</code></li>
		</ul>
	</div>
<h2>Implementace</h2>
<h3>Flask server - controller</h3>
<h4>__init__.py</h4>
<p>Soubor s konstantami pøístupových údajù a adresou databáze.</p>
<h4>databaseConnector.py</h4>
<p>Modul zaji¹»ující pøipojení a zasílání pøíkazù do databáze.</p>
<h4>iisUtils.py</h4>
<p>Modul s podpùrnými funkcemi pro práci s hlavním modulem.<br/>
	Zaji¹»uje následující funkce jako napøíklad:</p>
<ul>
	<li>zahashování pøijatého hesla funkcí <b>#hash_password</b>,</li>
	<li>zkontrolování hesla pomocí pomocí <b>#verify_password</b>,</li>
	<li>vygenerování náhodného identifikátoru pro pøihlá¹eného u¾ivatele <b>#random_uuid</b>,</li>
	<li>ukládání vlo¾ených obrázkù <b>#save_image</b>,</li>
	<li>zpracování nevhodných vstupù <b>#serializa_string</b>,</li>
	<li>èasto pou¾ívané SQL dotazy.</li>
</ul>
<h4>api.py</h4>
<p>Hlavní modul, který zpracovává pøíchozí GET/POST po¾adavky.<br/>
	Hlavní funkce:</p>
<ul>
	<li>pøidání nového u¾ivatelù - <b>#registration</b></li>
	<li>ovìøení hesla u¾ivatelù, který se pøihla¹uje - <b>#login</b></li>
	<li>získání a úpravu dat z DB o úètu pøihlá¹eného u¾ivatelù - <b>#account</b>, <b>#get_user_name</b>, <b>#get_role</b>, a <b>#update_account</b></li>
	<li>správa u¾ivatelù - <b>#get_users</b>, <b>#update_user_request</b> a <b>#remove_user</b></li>
	<li>správa obrázkù - <b>#upload_user_image</b>, <b>#get_profile_image</b>, <b>#upload_hotel_image</b>, <b>#get_hotel_image</b>, <b>#upload_room_image</b> a <b>#get_room_image</b></li>
	<li>zobrazení nabídky a správu hotelù - <b>#get_available_hotels</b>, <b>#get_hotels_admin</b>, <b>#get_hotels</b>, <b>#remove_hotel</b>, <b>#is_hotel_reserved</b>, <b>#edit_hotel</b> a <b>#edit_hotel</b></li>
	<li>zobrazení nabídky a správu pokojù - <b>#get_room_by_hotel_id</b>, <b>#is_room_reserved</b>, <b>#get_room_by_hotel_id_admin</b>, <b>#get_room</b>, <b>#remove_room</b>, <b>#add_room</b> a <b>#edit_room</b></li>
	<li>správa rezervací - <b>#book_room</b>, <b>#non_reg_booking</b>, <b>#reg_booking</b>, <b>#get_bookings</b>, <b>#get_all_bookings</b>, <b>#remove_booking</b> a <b>#update_booking</b></li>
	<li>vyhledání a kontrolu dostupnosti - <b>#check_dates</b> a <b>#search_hotel</b></li>
</ul>
<br/>
<h3>ReactSJ framework - frontend</h3>
<p>Front-end aplikace je rozdìlená do nìkolika komponet, které reprezentují jednolitvé
	èásti informaèního systému.<br/>
	Výpis hlavních komponent:</p>
<ul>
	<li>správa a zobrazení hotelù - komponenty z adresáøù <b>hotelsAdmin</b> a <b>hotelsPublic</b></li>
	<li>správa a zobrazení pokojù - komponenty z adresáøù <b>roomsAdmin</b> a <b>roomsPublic</b></li>
	<li>registrace a pøihlá¹ení u¾ivatele - komponenty z adresáøù <b>loginRegPage</b></li>
	<li>správa u¾ivatelù - komponenta z adresáøù <b>usersTable</b></li>
	<li>správa a zobrazení rezervací - komponenty z adresáøù <b>bookingsPublic</b> a <b>bookings</b></li>
	<li>správa u¾ivatelù úètu - komponenta z adresáøù <b>account</b></li>
</ul>
</p>
<br/>
<h3>Databáze</h3>
	<div><img src="DBschema.svg" height="1024px" alt="Database schema"></div>

<h2>Známé problémy</h2>
<p>Neregistrovaný u¾ivatel nemá mo¾nost zobrazení jeho vytvoøených rezervací.</p>

</body></html>